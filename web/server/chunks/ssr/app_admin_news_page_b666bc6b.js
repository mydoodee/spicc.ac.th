module.exports=[47691,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(65233),e=a.i(41227),f=a.i(77860);function g(){let{showToast:a}=(0,e.useToast)(),[g,h]=(0,c.useState)([]),[i,j]=(0,c.useState)(!0),[k,l]=(0,c.useState)(!1),[m,n]=(0,c.useState)({}),[o,p]=(0,c.useState)(!1),[q,r]=(0,c.useState)({news_title:"ข่าวสารและกิจกรรมล่าสุด",news_description:"ติดตามความเคลื่อนไหวและบรรยากาศในรั้ววิทยาลัย"}),[s,t]=(0,c.useState)(!1);(0,c.useEffect)(()=>{u(),v()},[]);let u=async()=>{try{let a=await fetch("/web/api/news"),b=await a.json();b.success&&h(b.news)}catch(a){console.error("Error fetching news:",a)}finally{j(!1)}},v=async()=>{try{let a=await fetch("/web/api/news/settings"),b=await a.json();b.success&&b.settings&&r(b.settings)}catch(a){console.error("Error fetching settings:",a)}},w=a=>{let{name:b,value:c}=a.target;r(a=>({...a,[b]:c}))},x=async b=>{b.preventDefault(),t(!0);try{(await fetch("/web/api/news/settings",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(q)})).ok?a("บันทึกการตั้งค่าส่วนหัวเรียบร้อยแล้ว","success"):a("ไม่สามารถบันทึกการตั้งค่าได้","error")}catch(b){a("เกิดข้อผิดพลาดในการอัปเดต: "+b.message,"error")}finally{t(!1)}},y=()=>{l(!1),n({})},z=a=>{let{name:b,value:c,type:d,checked:e}=a.target,f="checkbox"===d?e:c;n(a=>{let d={...a,[b]:f};return"title"!==b||a.slug&&a.slug!==a.title.toLowerCase().replace(/[^a-z0-9ก-ฮ]/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"")||(d.slug=c.toLowerCase().replace(/[^a-z0-9ก-ฮ]/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"")),d})},A=async b=>{let c=b.target.files[0];if(!c)return;let d=new FormData;d.append("file",c);try{let b=await fetch("/web/api/upload",{method:"POST",body:d}),c=await b.json();c.success&&(n(a=>({...a,image:c.url})),a("อัปโหลดรูปภาพสำเร็จ","success"))}catch(b){a("อัปโหลดรูปภาพไม่สำเร็จ","error")}},B=async a=>{let b=Array.from(a.target.files);if(0!==b.length)for(let a of b){let b=new FormData;b.append("file",a);try{let c=await fetch("/web/api/upload",{method:"POST",body:b}),d=await c.json();d.success&&n(b=>{let c=JSON.parse(b.gallery||"[]"),e={id:Date.now()+Math.random().toString(36).substr(2,9),url:d.url,name:a.name,type:a.type.includes("image")?"image":"file"};return{...b,gallery:JSON.stringify([...c,e])}})}catch(b){console.error("Upload failed for file:",a.name)}}},C=async b=>{b.preventDefault(),p(!0);try{let b=m.id?"PUT":"POST";(await fetch("/web/api/news",{method:b,headers:{"Content-Type":"application/json"},body:JSON.stringify(m)})).ok?(await u(),l(!1),a("บันทึกข้อมูลข่าวสารเรียบร้อยแล้ว","success")):a("ไม่สามารถบันทึกข้อมูลได้","error")}catch(b){a("เกิดข้อผิดพลาดในการบันทึก: "+b.message,"error")}finally{p(!1)}},D=async b=>{if(confirm("Are you sure you want to delete this news?"))try{(await fetch(`/web/api/news?id=${b}`,{method:"DELETE"})).ok&&(u(),v(),a("ลบข้อมูลข่าวสารเรียบร้อยแล้ว","success"))}catch(b){a("เกิดข้อผิดพลาดในการลบ: "+b.message,"error")}},E=g.reduce((a,b)=>{let c=b.date.match(/\d{4}/),d=c?c[0]:"อื่นๆ";return a[d]||(a[d]=[]),a[d].push(b),a},{});return i?(0,b.jsx)("div",{className:"p-8",children:"Loading..."}):(0,b.jsxs)("div",{className:"admin-layout",children:[(0,b.jsx)(d.default,{}),(0,b.jsxs)("div",{className:"admin-content",children:[(0,b.jsx)("header",{className:"admin-header",children:(0,b.jsx)("div",{className:"admin-header-left",children:(0,b.jsx)("h1",{children:"จัดการข่าวสาร (News)"})})}),(0,b.jsxs)("main",{className:"admin-main",children:[!k&&(0,b.jsxs)("div",{className:"admin-card",style:{marginBottom:"32px",padding:"24px"},children:[(0,b.jsxs)("h2",{style:{marginBottom:"20px",display:"flex",alignItems:"center",gap:"8px"},children:[(0,b.jsx)("span",{className:"material-icons text-[#2b4a8a]",children:"settings"}),"ตั้งค่าส่วนหัวข้อข่าว (News Header)"]}),(0,b.jsxs)("form",{onSubmit:x,style:{display:"grid",gap:"20px"},children:[(0,b.jsxs)("div",{className:"form-group",style:{margin:0},children:[(0,b.jsx)("label",{children:"หัวข้อ (Section Title)"}),(0,b.jsx)("input",{type:"text",name:"news_title",value:q.news_title,onChange:w,placeholder:"เช่น ข่าวสารและกิจกรรมล่าสุด",required:!0})]}),(0,b.jsxs)("div",{className:"form-group",style:{margin:0},children:[(0,b.jsx)("label",{children:"คำอธิบาย (Section Description)"}),(0,b.jsx)("textarea",{name:"news_description",value:q.news_description,onChange:w,placeholder:"เช่น ติดตามความเคลื่อนไหวและบรรยากาศในรั้ววิทยาลัย",rows:"2",required:!0})]}),(0,b.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:(0,b.jsx)("button",{type:"submit",className:"btn-primary",disabled:s,children:s?"กำลังบันทึก...":"บันทึกการตั้งค่าส่วนหัว"})})]})]}),k?(0,b.jsxs)("div",{className:"editor-card",style:{maxWidth:"800px",margin:"0 auto"},children:[(0,b.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"24px"},children:[(0,b.jsx)("h2",{style:{margin:0,color:"#f1f5f9"},children:m.id?"แก้ไขข่าวสาร":"เพิ่มข่าวใหม่"}),(0,b.jsx)("button",{onClick:y,style:{background:"none",border:"none",cursor:"pointer",color:"#64748b"},children:(0,b.jsx)("span",{className:"material-icons",children:"close"})})]}),(0,b.jsx)("form",{onSubmit:C,className:"login-form",children:(0,b.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 2fr",gap:"24px"},children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{style:{width:"100%",aspectRatio:"16/9",background:"#f1f5f9",borderRadius:"8px",overflow:"hidden",marginBottom:"12px",border:"2px dashed #cbd5e1",display:"flex",alignItems:"center",justifyContent:"center"},children:m.image?(0,b.jsx)("img",{src:(0,f.normalizePath)(m.image),alt:"Preview",style:{width:"100%",height:"100%",objectFit:"cover"}}):(0,b.jsx)("span",{className:"material-icons",style:{fontSize:"48px",color:"#cbd5e1"},children:"image"})}),(0,b.jsx)("input",{type:"file",accept:"image/*",onChange:A,style:{width:"100%"}}),(0,b.jsxs)("div",{style:{marginTop:"20px",padding:"16px",background:"#f8fafc",borderRadius:"8px",border:"1px solid #e2e8f0"},children:[(0,b.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:"12px",cursor:"pointer"},children:[(0,b.jsx)("input",{type:"checkbox",name:"is_featured",checked:m.is_featured||!1,onChange:z,style:{width:"20px",height:"20px"}}),(0,b.jsx)("span",{style:{fontWeight:"600",color:"#1e293b"},children:"ตั้งเป็นข่าวเด่น (Featured)"})]}),(0,b.jsx)("p",{style:{fontSize:"12px",color:"#64748b",marginTop:"8px",marginLeft:"32px"},children:"ข่าวเด่นจะแสดงในสไลด์ด้านบนสุดของหน้าข่าว"})]})]}),(0,b.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[(0,b.jsxs)("div",{className:"form-group",children:[(0,b.jsx)("label",{style:{color:"#f1f5f9"},children:"หัวข้อข่าว"}),(0,b.jsx)("input",{type:"text",name:"title",required:!0,value:m.title||"",onChange:z,placeholder:"หัวข้อข่าว...",style:{background:"#1e293b",border:"1px solid #334155",color:"white"}})]}),(0,b.jsxs)("div",{className:"form-group",children:[(0,b.jsx)("label",{style:{color:"#f1f5f9"},children:"URL Slug (ควรใช้ภาษาอังกฤษและตัวเลข เพื่อรองรับ SEO)"}),(0,b.jsx)("input",{type:"text",name:"slug",required:!0,value:m.slug||"",onChange:z,placeholder:"เช่น graduation-ceremony-2024",style:{background:"#1e293b",border:"1px solid #334155",color:"white"}})]}),(0,b.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[(0,b.jsxs)("div",{className:"form-group",children:[(0,b.jsx)("label",{style:{color:"#f1f5f9"},children:"หมวดหมู่"}),(0,b.jsxs)("select",{name:"category",value:m.category||"Activity",onChange:z,style:{width:"100%",padding:"10px",borderRadius:"6px",border:"1px solid #334155",background:"#1e293b",color:"white"},children:[(0,b.jsx)("option",{value:"Activity",children:"กิจกรรม (Activity)"}),(0,b.jsx)("option",{value:"Press",children:"ประชาสัมพันธ์ (Press)"}),(0,b.jsx)("option",{value:"Workshop",children:"อบรม/สัมมนา (Workshop)"}),(0,b.jsx)("option",{value:"Sports",children:"กีฬา (Sports)"}),(0,b.jsx)("option",{value:"International",children:"นานาชาติ (International)"}),(0,b.jsx)("option",{value:"Academic",children:"วิชาการ (Academic)"})]})]}),(0,b.jsxs)("div",{className:"form-group",children:[(0,b.jsx)("label",{style:{color:"#f1f5f9"},children:"วันที่"}),(0,b.jsx)("input",{type:"text",name:"date",required:!0,value:m.date||"",onChange:z,placeholder:"เช่น 12 พ.ย. 2566",style:{background:"#1e293b",border:"1px solid #334155",color:"white"}})]})]}),(0,b.jsxs)("div",{className:"form-group",children:[(0,b.jsx)("label",{style:{color:"#f1f5f9"},children:"รายละเอียด"}),(0,b.jsx)("textarea",{name:"description",rows:"6",value:m.description||"",onChange:z,placeholder:"เนื้อหาข่าวโดยย่อ...",style:{background:"#1e293b",border:"1px solid #334155",color:"white"}})]}),(0,b.jsxs)("div",{className:"form-group",style:{marginTop:"20px"},children:[(0,b.jsx)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"bold",color:"#f1f5f9"},children:"คลังรูปภาพและไฟล์แนบ (Gallery & Attachments)"}),(0,b.jsxs)("div",{style:{padding:"16px",background:"rgba(255,255,255,0.05)",borderRadius:"12px",border:"1px solid #334155"},children:[(0,b.jsx)("div",{style:{marginBottom:"16px"},children:(0,b.jsxs)("label",{className:"btn-secondary",style:{display:"inline-flex",alignItems:"center",gap:"8px",cursor:"pointer",background:"#334155",color:"white",padding:"8px 16px",borderRadius:"8px",fontSize:"14px"},children:[(0,b.jsx)("span",{className:"material-icons",children:"cloud_upload"}),"เลือกรูปภาพ/PDF เพิ่มเติม",(0,b.jsx)("input",{type:"file",multiple:!0,accept:"image/*,.pdf",onChange:B,style:{display:"none"}})]})}),(0,b.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(100px, 1fr))",gap:"12px"},children:JSON.parse(m.gallery||"[]").map(a=>(0,b.jsxs)("div",{style:{position:"relative",group:"true"},children:["image"===a.type?(0,b.jsx)("div",{style:{width:"100%",aspectRatio:"1/1",borderRadius:"8px",overflow:"hidden",border:"1px solid #cbd5e1"},children:(0,b.jsx)("img",{src:(0,f.normalizePath)(a.url),alt:"",style:{width:"100%",height:"100%",objectFit:"cover"}})}):(0,b.jsxs)("div",{style:{width:"100%",aspectRatio:"1/1",borderRadius:"8px",background:"#f1f5f9",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",border:"1px solid #cbd5e1",padding:"8px",textAlign:"center"},children:[(0,b.jsx)("span",{className:"material-icons",style:{color:"#ef4444"},children:"picture_as_pdf"}),(0,b.jsx)("span",{style:{fontSize:"10px",marginTop:"4px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",width:"100%"},children:a.name})]}),(0,b.jsx)("button",{type:"button",onClick:()=>{var b;return b=a.id,void n(a=>{let c=JSON.parse(a.gallery||"[]").filter(a=>a.id!==b);return{...a,gallery:JSON.stringify(c)}})},style:{position:"absolute",top:"-8px",right:"-8px",background:"#ef4444",color:"white",borderRadius:"full",width:"24px",height:"24px",border:"none",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",zIndex:1},children:(0,b.jsx)("span",{className:"material-icons",style:{fontSize:"14px"},children:"close"})})]},a.id))})]})]}),(0,b.jsxs)("div",{style:{display:"flex",gap:"12px",marginTop:"20px"},children:[(0,b.jsx)("button",{type:"button",onClick:y,className:"btn-secondary",style:{flex:1,justifyContent:"center",background:"#334155",color:"white",border:"none",height:"48px",borderRadius:"12px",fontWeight:"bold"},children:"ยกเลิก"}),(0,b.jsx)("button",{type:"submit",className:"btn-primary",disabled:o,style:{flex:1,justifyContent:"center",background:"#f2cc0d",color:"#1e293b",border:"none",height:"48px",borderRadius:"12px",fontWeight:"bold",boxShadow:"0 4px 12px rgba(242, 204, 13, 0.2)"},children:o?"กำลังบันทึก...":"บันทึกข้อมูล"})]})]})]})})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[(0,b.jsx)("h2",{style:{margin:0},children:"รายการข่าวสารทั้งหมด"}),(0,b.jsxs)("button",{onClick:()=>{n({title:"",description:"",date:new Date().toLocaleDateString("th-TH",{day:"numeric",month:"long",year:"numeric"}),category:"Activity",image:"",slug:"",gallery:"[]",is_featured:!1}),l(!0)},className:"btn-primary",style:{gap:"8px"},children:[(0,b.jsx)("span",{className:"material-icons",children:"add"}),"เพิ่มข่าวใหม่"]})]}),Object.keys(E).sort((a,b)=>b-a).map(a=>(0,b.jsxs)("div",{style:{marginBottom:"40px"},children:[(0,b.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"16px",marginBottom:"24px"},children:[(0,b.jsxs)("h2",{style:{margin:0,fontSize:"20px",color:"#2b4a8a"},children:["พ.ศ. ",a]}),(0,b.jsx)("div",{style:{flex:1,height:"1px",background:"#e2e8f0"}})]}),(0,b.jsx)("div",{className:"admin-grid",style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"24px"},children:E[a].map(a=>(0,b.jsxs)("div",{className:"admin-card",style:{background:"white",borderRadius:"12px",overflow:"hidden",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)",display:"flex",flexDirection:"column"},children:[(0,b.jsxs)("div",{style:{height:"200px",overflow:"hidden",position:"relative"},children:[(0,b.jsx)("img",{src:(0,f.normalizePath)(a.image||"https://via.placeholder.com/300x200?text=No+Image"),alt:a.title,style:{width:"100%",height:"100%",objectFit:"cover"}}),a.is_featured&&(0,b.jsx)("div",{style:{position:"absolute",top:"10px",right:"10px",background:"#f2cc0d",color:"#2b4a8a",padding:"4px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:"bold"},children:"ข่าวเด่น"}),(0,b.jsx)("div",{style:{position:"absolute",bottom:"10px",left:"10px",background:"rgba(0,0,0,0.6)",color:"white",padding:"4px 8px",borderRadius:"4px",fontSize:"12px"},children:a.category})]}),(0,b.jsxs)("div",{style:{padding:"20px",flex:1,display:"flex",flexDirection:"column"},children:[(0,b.jsx)("div",{style:{fontSize:"12px",color:"#94a3b8",marginBottom:"8px"},children:a.date}),(0,b.jsx)("h3",{style:{margin:"0 0 8px 0",fontSize:"16px",color:"#1e293b",fontWeight:"600",lineHeight:"1.4"},children:a.title}),(0,b.jsx)("p",{style:{margin:"0 0 20px 0",color:"#64748b",fontSize:"13px",lineHeight:"1.5",flex:1,display:"-webkit-box",WebkitLineClamp:3,WebkitBoxOrient:"vertical",overflow:"hidden"},children:a.description}),(0,b.jsxs)("div",{style:{display:"flex",gap:"10px",marginTop:"auto"},children:[(0,b.jsxs)("button",{onClick:()=>{n(a),l(!0)},style:{flex:1,padding:"8px",border:"1px solid #e2e8f0",borderRadius:"6px",background:"white",color:"#475569",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"4px",fontSize:"13px"},children:[(0,b.jsx)("span",{className:"material-icons",style:{fontSize:"16px"},children:"edit"}),"แก้ไขข่าว"]}),(0,b.jsxs)("button",{onClick:()=>D(a.id),style:{flex:1,padding:"8px",border:"1px solid #fee2e2",borderRadius:"6px",background:"#fef2f2",color:"#ef4444",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"4px",fontSize:"13px"},children:[(0,b.jsx)("span",{className:"material-icons",style:{fontSize:"16px"},children:"delete"}),"ลบ"]})]})]})]},a.id))})]},a))]})]})]})]})}a.s(["default",()=>g])}];

//# sourceMappingURL=app_admin_news_page_b666bc6b.js.map
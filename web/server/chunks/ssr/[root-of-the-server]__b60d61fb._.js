module.exports=[56704,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},20635,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},9270,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.AppRouterContext},36313,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.HooksClientContext},18341,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.ServerInsertedHtml},38783,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactServerDOMTurbopackClient},77860,a=>{"use strict";function b(a){return a?a.startsWith("http://")||a.startsWith("https://")||a.startsWith("data:")?a:a.startsWith("/uploads/")&&!a.startsWith("/web/uploads/")?`/web${a}`:!a.startsWith("/")&&[".jpg",".jpeg",".png",".gif",".svg",".webp",".pdf"].some(b=>a.toLowerCase().endsWith(b))?`/web/uploads/${a}`:a:""}a.s(["normalizePath",()=>b])},65233,a=>{"use strict";var b=a.i(87924);a.i(72131);var c=a.i(38246),d=a.i(50944);function e(){let a=(0,d.usePathname)();return(0,b.jsxs)("aside",{className:"admin-sidebar",children:[(0,b.jsxs)("div",{className:"sidebar-brand",children:[(0,b.jsx)("div",{className:"sidebar-logo",children:(0,b.jsx)("span",{className:"material-icons",children:"school"})}),(0,b.jsx)("span",{className:"sidebar-title",children:"SPICC ADMIN"})]}),(0,b.jsxs)("nav",{className:"sidebar-nav",children:[(0,b.jsx)("div",{className:"sidebar-nav-label",children:"Main Menu"}),[{name:"Dashboard",href:"/admin",icon:"dashboard"},{name:"จัดการส่วนหัว",href:"/admin/hero",icon:"view_carousel"},{name:"จัดการหน้าคั่น",href:"/admin/landing-page",icon:"auto_awesome"},{name:"จัดการหลักสูตร",href:"/admin/courses",icon:"school"},{name:"จัดการแผนกวิชา",href:"/admin/departments",icon:"category"},{name:"จัดการบุคลากร",href:"/admin/personnel",icon:"groups"},{name:"จัดการข่าวสาร",href:"/admin/news",icon:"newspaper"},{name:"จัดการเกี่ยวกับเรา",href:"/admin/about",icon:"info"},{name:"จัดการเมนู",href:"/admin/menus",icon:"sort"},{name:"จัดการเพจ",href:"/admin/pages",icon:"article"},{name:"จัดการส่วนท้าย",href:"/admin/footer",icon:"wrap_text"},{name:"ตั้งค่าเว็บไซต์",href:"/admin/settings",icon:"settings"}].map(d=>{let e=a===d.href;return(0,b.jsxs)(c.default,{href:d.href,className:`sidebar-link ${e?"active":""}`,children:[(0,b.jsx)("span",{className:"material-icons",children:d.icon}),d.name]},d.href)})]}),(0,b.jsx)("div",{className:"sidebar-footer",children:(0,b.jsx)("div",{className:"text-xs text-white/30 text-center",children:"Version 1.0.0"})})]})}a.s(["default",()=>e])},44987,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(65233),f=a.i(77860);function g(){let a=(0,d.useRouter)(),g=(0,d.useSearchParams)().get("id"),h=(0,c.useRef)(null),[i,j]=(0,c.useState)({title:"",slug:"",content:"",is_published:!0,gallery:"[]"}),[k,l]=(0,c.useState)(!0),[m,n]=(0,c.useState)(!1),[o,p]=(0,c.useState)(""),[q,r]=(0,c.useState)(null),[s,t]=(0,c.useState)(!1),[u,v]=(0,c.useState)([]),[w,x]=(0,c.useState)(!1),[y,z]=(0,c.useState)(""),[A,B]=(0,c.useState)("ทั่วไป"),[C,D]=(0,c.useState)("");(0,c.useEffect)(()=>{(async()=>{await F(),H()})()},[]),(0,c.useEffect)(()=>{g?G():(j({title:"",slug:"",content:"",is_published:!0,gallery:"[]"}),h.current&&(h.current.root.innerHTML=""))},[g]),(0,c.useEffect)(()=>{},[k]);let E=async a=>{let b=Array.from(a.target.files);if(0!==b.length)for(let a of b){let b=new FormData;b.append("file",a);try{let c=await fetch("/web/api/upload",{method:"POST",body:b}),d=await c.json();d.success&&j(b=>{let c=JSON.parse(b.gallery||"[]"),e={id:Date.now()+Math.random().toString(36).substr(2,9),url:d.url,name:a.name,type:a.type.includes("image")?"image":"file",group:A||"ทั่วไป"};return{...b,gallery:JSON.stringify([...c,e])}})}catch(b){console.error("Upload failed for file:",a.name)}}},F=async()=>{(await fetch("/web/api/auth/me",{cache:"no-store"})).ok?l(!1):a.push("/admin/login")},G=async()=>{let a=await fetch(`/web/api/pages/${g}`,{cache:"no-store"}),b=await a.json();b.page&&(j({title:b.page.title,slug:b.page.slug,content:b.page.content||"",is_published:!!b.page.is_published,gallery:b.page.gallery||"[]"}),h.current&&(h.current.root.innerHTML=b.page.content||""))},H=async()=>{let a=await fetch("/web/api/menus",{cache:"no-store"});v((await a.json()).allMenus||[])},I=async()=>{if(!i.title||!i.slug)return void p("กรุณากรอก title และ slug");n(!0),p("");try{let b=g?`/web/api/pages/${g}`:"/web/api/pages",c=g?"PUT":"POST",d=await fetch(b,{method:c,headers:{"Content-Type":"application/json"},body:JSON.stringify(i)}),e=await d.json();if(!d.ok){p(e.error||"เกิดข้อผิดพลาด"),n(!1);return}p("บันทึกสำเร็จ!"),n(!1),!g&&e.page?.id&&a.push(`/admin/pages/editor?id=${e.page.id}`)}catch(a){p("เกิดข้อผิดพลาด: "+a.message),n(!1)}},J=async()=>{x(!0);try{let a=await fetch("/web/api/menus",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:i.title,page_id:g,parent_id:y||null,is_active:1,sort_order:0})});if(a.ok)p("เชื่อมต่อเมนูเรียบร้อยแล้ว!"),t(!1);else{let b=await a.json();p("เชื่อมต่อเมนูไม่สำเร็จ: "+(b.error||"Unknown error"))}}catch(a){p("Error linking menu: "+a.message)}finally{x(!1)}};return k?(0,b.jsxs)("div",{className:"admin-loading",children:[(0,b.jsx)("div",{className:"admin-loading-spinner"}),(0,b.jsx)("p",{children:"กำลังโหลด..."})]}):(0,b.jsxs)("div",{className:"admin-layout",children:[(0,b.jsx)(e.default,{}),(0,b.jsxs)("div",{className:"admin-content",children:[(0,b.jsxs)("header",{className:"admin-header",children:[(0,b.jsxs)("div",{className:"admin-header-left",children:[(0,b.jsx)("button",{className:"btn-back",onClick:()=>a.push("/admin/pages"),children:(0,b.jsx)("span",{className:"material-icons",children:"arrow_back"})}),(0,b.jsx)("h1",{children:g?"แก้ไขเพจ":"สร้างเพจใหม่"})]}),(0,b.jsxs)("div",{className:"admin-header-right",children:[g&&(0,b.jsxs)("a",{className:"btn-secondary",href:`/page/${i.slug}`,target:"_blank",children:[(0,b.jsx)("span",{className:"material-icons",children:"open_in_new"})," ดูตัวอย่าง"]}),(0,b.jsxs)("button",{className:"btn-primary",onClick:I,disabled:m,children:[(0,b.jsx)("span",{className:"material-icons",children:m?"hourglass_empty":"save"}),m?"กำลังบันทึก...":"บันทึก"]})]})]}),(0,b.jsxs)("main",{className:"admin-main",children:[o&&(0,b.jsxs)("div",{className:`editor-message ${o.includes("สำเร็จ")?"success":"error"}`,children:[(0,b.jsx)("span",{className:"material-icons",children:o.includes("สำเร็จ")?"check_circle":"error"}),o]}),(0,b.jsxs)("div",{className:"editor-grid",children:[(0,b.jsx)("div",{className:"editor-main-col",children:(0,b.jsxs)("div",{className:"editor-card mb-6",children:[(0,b.jsxs)("div",{className:"form-group mb-6",children:[(0,b.jsx)("label",{children:"ชื่อเพจ"}),(0,b.jsx)("input",{className:"editor-title-input",value:i.title,onChange:a=>{let b=a.target.value;j(a=>({...a,title:b,slug:g?a.slug:b.toLowerCase().replace(/[^a-z0-9ก-๙\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").trim()}))},placeholder:"ชื่อเพจ เช่น เกี่ยวกับเรา"})]}),(0,b.jsxs)("div",{className:"form-group",children:[(0,b.jsx)("label",{children:"เนื้อหาเพจ"}),(0,b.jsx)("div",{id:"editor-container",style:{minHeight:"400px"}})]})]})}),(0,b.jsx)("div",{className:"editor-side-col",children:(0,b.jsxs)("div",{className:"editor-card",children:[(0,b.jsx)("h4",{children:"ตั้งค่าหัวข้อ URL"}),(0,b.jsxs)("div",{className:"form-group mb-4",children:[(0,b.jsx)("label",{children:"Slug (URL)"}),(0,b.jsxs)("div",{className:"slug-input-wrap",children:[(0,b.jsx)("span",{className:"slug-prefix",children:"/page/"}),(0,b.jsx)("input",{value:i.slug,onChange:a=>j({...i,slug:a.target.value}),placeholder:"about-us"})]})]}),(0,b.jsxs)("div",{className:"form-group mb-4",children:[(0,b.jsx)("label",{children:"สถานะการเผยแพร่"}),(0,b.jsxs)("select",{value:i.is_published?"1":"0",onChange:a=>j({...i,is_published:"1"===a.target.value}),className:"w-full bg-white/5 border border-white/10 rounded-lg p-2 text-white",children:[(0,b.jsx)("option",{value:"0",children:"ฉบับร่าง (Draft)"}),(0,b.jsx)("option",{value:"1",children:"เผยแพร่ (Published)"})]})]}),(0,b.jsxs)("div",{className:"form-group mb-4",children:[(0,b.jsx)("label",{style:{display:"block",marginBottom:"12px",fontWeight:"bold",color:"white",fontSize:"1.1rem"},children:(0,b.jsx)("span",{className:"material-icons",style:{verticalAlign:"middle",marginRight:"8px"},children:"collections"})}),(0,b.jsxs)("div",{style:{padding:"16px",background:"rgba(255,255,255,0.05)",borderRadius:"12px",border:"1px solid rgba(255,255,255,0.1)"},children:[(0,b.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,b.jsx)("label",{style:{fontSize:"0.8rem",color:"#94a3b8",display:"block",marginBottom:"8px"},children:"เลือกกลุ่มที่จะอัปโหลด:"}),(0,b.jsx)("div",{style:{display:"flex",gap:"8px",marginBottom:"12px",flexWrap:"wrap"},children:Array.from(new Set([...JSON.parse(i.gallery||"[]").map(a=>a.group||"ทั่วไป"),"ทั่วไป"])).map(a=>(0,b.jsx)("button",{type:"button",onClick:()=>B(a),style:{padding:"4px 12px",borderRadius:"20px",fontSize:"12px",background:A===a?"#3b82f6":"rgba(255,255,255,0.1)",color:"white",border:"none",cursor:"pointer"},children:a},a))}),(0,b.jsxs)("div",{style:{display:"flex",gap:"8px"},children:[(0,b.jsx)("input",{type:"text",placeholder:"เพิ่มกลุ่มใหม่...",value:C,onChange:a=>D(a.target.value),style:{flex:1,padding:"6px 12px",borderRadius:"6px",background:"rgba(255,255,255,0.05)",border:"1px solid rgba(255,255,255,0.2)",color:"white",fontSize:"13px"}}),(0,b.jsx)("button",{type:"button",onClick:()=>{C.trim()&&(B(C.trim()),D(""))},style:{padding:"6px 12px",borderRadius:"6px",background:"#10b981",color:"white",border:"none",cursor:"pointer",fontSize:"13px"},children:"สร้าง"})]})]}),(0,b.jsx)("div",{style:{marginBottom:"16px"},children:(0,b.jsxs)("label",{className:"btn-secondary",style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",cursor:"pointer",background:"linear-gradient(135deg, #3b82f6, #2563eb)",color:"white",padding:"10px 16px",borderRadius:"8px",fontSize:"14px",border:"none",boxShadow:"0 4px 12px rgba(59, 130, 246, 0.3)"},children:[(0,b.jsx)("span",{className:"material-icons",children:"cloud_upload"}),'อัปโหลดเข้ากลุ่ม "',A,'"',(0,b.jsx)("input",{type:"file",multiple:!0,accept:"image/*,.pdf",onChange:E,style:{display:"none"}})]})}),Array.from(new Set(JSON.parse(i.gallery||"[]").map(a=>a.group||"ทั่วไป"))).sort().map(a=>{let c=JSON.parse(i.gallery||"[]").filter(b=>(b.group||"ทั่วไป")===a);return(0,b.jsxs)("div",{style:{marginBottom:"24px"},children:[(0,b.jsxs)("h5",{style:{fontSize:"0.9rem",color:"#60a5fa",marginBottom:"12px",borderBottom:"1px solid rgba(96, 165, 250, 0.2)",paddingBottom:"4px",display:"flex",justifyContent:"space-between"},children:[(0,b.jsx)("span",{children:a}),(0,b.jsxs)("span",{style:{fontSize:"0.7rem",color:"#94a3b8"},children:[c.length," รายการ"]})]}),(0,b.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(80px, 1fr))",gap:"12px"},children:c.map(a=>(0,b.jsxs)("div",{style:{position:"relative",group:"group"},children:["image"===a.type?(0,b.jsx)("div",{style:{width:"100%",aspectRatio:"1/1",borderRadius:"8px",overflow:"hidden",border:"1px solid rgba(255,255,255,0.2)"},children:(0,b.jsx)("img",{src:(0,f.normalizePath)(a.url),alt:"",style:{width:"100%",height:"100%",objectFit:"cover"}})}):(0,b.jsxs)("div",{style:{width:"100%",aspectRatio:"1/1",borderRadius:"8px",background:"rgba(255,255,255,0.05)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",border:"1px solid rgba(255,255,255,0.2)",padding:"8px",textAlign:"center"},children:[(0,b.jsx)("span",{className:"material-icons",style:{color:"#ef4444"},children:"picture_as_pdf"}),(0,b.jsx)("span",{style:{fontSize:"10px",marginTop:"4px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",width:"100%",color:"white"},children:a.name})]}),(0,b.jsx)("button",{type:"button",onClick:()=>{var b;return b=a.id,void j(a=>{let c=JSON.parse(a.gallery||"[]").filter(a=>a.id!==b);return{...a,gallery:JSON.stringify(c)}})},style:{position:"absolute",top:"-8px",right:"-8px",background:"#ef4444",color:"white",borderRadius:"50%",width:"24px",height:"24px",border:"none",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",zIndex:1},children:(0,b.jsx)("span",{className:"material-icons",style:{fontSize:"14px"},children:"close"})})]},a.id))})]},a)})]})]}),g&&(0,b.jsxs)("button",{className:"btn-link-menu",onClick:()=>t(!0),children:[(0,b.jsx)("span",{className:"material-icons",children:"link"}),"นำไปใส่ในเมนู"]})]})})]})]}),s&&(0,b.jsx)("div",{className:"modal-overlay",children:(0,b.jsxs)("div",{className:"modal-content",children:[(0,b.jsxs)("div",{className:"modal-header",children:[(0,b.jsx)("h3",{children:"เชื่อมต่อเข้ากับเมนู"}),(0,b.jsx)("button",{className:"modal-close",onClick:()=>t(!1),children:(0,b.jsx)("span",{className:"material-icons",children:"close"})})]}),(0,b.jsxs)("div",{className:"modal-body",children:[(0,b.jsx)("p",{className:"text-sm text-slate-400 mb-4",children:"เลือกเมนูหลักที่ต้องการให้หน้าเพจนี้ไปแสดงผล (ว่างไว้หากเป็นเมนูหลัก)"}),(0,b.jsxs)("div",{className:"form-group",children:[(0,b.jsx)("label",{children:"เมนูหลัก (Parent)"}),(0,b.jsxs)("select",{className:"w-full",value:y,onChange:a=>z(a.target.value),children:[(0,b.jsx)("option",{value:"",children:"-- เป็นเมนูหลัก --"}),u.filter(a=>!a.parent_id).map(a=>(0,b.jsx)("option",{value:a.id,children:a.title},a.id))]})]})]}),(0,b.jsxs)("div",{className:"modal-footer",children:[(0,b.jsx)("button",{className:"btn-secondary",onClick:()=>t(!1),children:"ยกเลิก"}),(0,b.jsx)("button",{className:"btn-primary",onClick:J,disabled:w,children:w?"กำลังบันทึก...":"ยันยืนการเพิ่มเมนู"})]})]})})]})]})}function h(){return(0,b.jsx)(c.Suspense,{fallback:(0,b.jsxs)("div",{className:"admin-loading",children:[(0,b.jsx)("div",{className:"admin-loading-spinner"}),(0,b.jsx)("p",{children:"กำลังโหลด..."})]}),children:(0,b.jsx)(g,{})})}a.s(["default",()=>h])}];

//# sourceMappingURL=%5Broot-of-the-server%5D__b60d61fb._.js.map
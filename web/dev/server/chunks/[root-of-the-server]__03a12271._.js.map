{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Lenovo11/Desktop/xx/spicc.ac.th-main/lib/db.js"],"sourcesContent":["import mysql from 'mysql2/promise';\r\n// Ensure mysql2 is used as a server-only package\r\n\r\nlet pool = global.dbPool || null;\r\n\r\nfunction getPool() {\r\n    if (!pool) {\r\n        pool = mysql.createPool({\r\n            host: process.env.DB_HOST,\r\n            user: process.env.DB_USER,\r\n            password: process.env.DB_PASSWORD,\r\n            database: process.env.DB_NAME,\r\n            port: parseInt(process.env.DB_PORT || '3306'),\r\n            waitForConnections: true,\r\n            connectionLimit: 10,\r\n            queueLimit: 0,\r\n            connectTimeout: 30000,\r\n            enableKeepAlive: true,\r\n            keepAliveInitialDelay: 0,\r\n            charset: 'utf8mb4',\r\n        });\r\n        global.dbPool = pool;\r\n    }\r\n    return pool;\r\n}\r\n\r\nexport async function query(sql, params = []) {\r\n    const pool = getPool();\r\n    const [rows] = await pool.execute(sql, params);\r\n    return rows;\r\n}\r\n\r\nexport default getPool;\r\n"],"names":[],"mappings":";;;;;;AAAA;;AACA,iDAAiD;AAEjD,IAAI,OAAO,yDAAO,MAAM,IAAI;AAE5B,SAAS;IACL,IAAI,CAAC,MAAM;QACP,OAAO,mLAAK,CAAC,UAAU,CAAC;YACpB,MAAM,QAAQ,GAAG,CAAC,OAAO;YACzB,MAAM,QAAQ,GAAG,CAAC,OAAO;YACzB,UAAU,QAAQ,GAAG,CAAC,WAAW;YACjC,UAAU,QAAQ,GAAG,CAAC,OAAO;YAC7B,MAAM,SAAS,QAAQ,GAAG,CAAC,OAAO,IAAI;YACtC,oBAAoB;YACpB,iBAAiB;YACjB,YAAY;YACZ,gBAAgB;YAChB,iBAAiB;YACjB,uBAAuB;YACvB,SAAS;QACb;QACA,yDAAO,MAAM,GAAG;IACpB;IACA,OAAO;AACX;AAEO,eAAe,MAAM,GAAG,EAAE,SAAS,EAAE;IACxC,MAAM,OAAO;IACb,MAAM,CAAC,KAAK,GAAG,MAAM,KAAK,OAAO,CAAC,KAAK;IACvC,OAAO;AACX;uCAEe"}},
    {"offset": {"line": 86, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Lenovo11/Desktop/xx/spicc.ac.th-main/app/api/footer/route.js"],"sourcesContent":["import { NextResponse } from 'next/server';\r\nimport { query } from '@/lib/db';\r\n\r\nexport async function GET() {\r\n    try {\r\n        const settings = await query('SELECT * FROM cms_footer_settings LIMIT 1');\r\n        const links = await query('SELECT * FROM cms_footer_links ORDER BY sort_order ASC');\r\n\r\n        return NextResponse.json({\r\n            success: true,\r\n            settings: settings[0] || null,\r\n            links: links\r\n        });\r\n    } catch (error) {\r\n        console.error('Fetch footer error:', error);\r\n        return NextResponse.json({ success: false, error: error.message }, { status: 500 });\r\n    }\r\n}\r\n\r\nexport async function PUT(request) {\r\n    try {\r\n        const data = await request.json();\r\n        const {\r\n            description, facebook_url, website_url, address, phone, email, copyright,\r\n            show_wave, wave_color, privacy_policy_url, terms_of_use_url,\r\n            privacy_policy_content, terms_of_use_content\r\n        } = data;\r\n\r\n        const result = await query(\r\n            `UPDATE cms_footer_settings \r\n       SET description = ?, facebook_url = ?, website_url = ?, address = ?, phone = ?, email = ?, copyright = ?,\r\n           show_wave = ?, wave_color = ?, privacy_policy_url = ?, terms_of_use_url = ?,\r\n           privacy_policy_content = ?, terms_of_use_content = ?\r\n       WHERE id = 1`,\r\n            [\r\n                description, facebook_url, website_url, address, phone, email, copyright,\r\n                show_wave ? 1 : 0, wave_color, privacy_policy_url, terms_of_use_url,\r\n                privacy_policy_content, terms_of_use_content\r\n            ]\r\n        );\r\n\r\n        if (result.affectedRows === 0) {\r\n            // If for some reason settings don't exist, insert them\r\n            await query(\r\n                `INSERT INTO cms_footer_settings (\r\n                    description, facebook_url, website_url, address, phone, email, copyright, \r\n                    show_wave, wave_color, privacy_policy_url, terms_of_use_url,\r\n                    privacy_policy_content, terms_of_use_content\r\n                )\r\n         VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)`,\r\n                [\r\n                    description, facebook_url, website_url, address, phone, email, copyright,\r\n                    show_wave ? 1 : 0, wave_color, privacy_policy_url, terms_of_use_url,\r\n                    privacy_policy_content, terms_of_use_content\r\n                ]\r\n            );\r\n        }\r\n\r\n        return NextResponse.json({ success: true, message: 'บันทึกข้อมูลส่วนท้ายเรียบร้อยแล้ว' });\r\n    } catch (error) {\r\n        console.error('Update footer error:', error);\r\n        return NextResponse.json({ success: false, error: error.message }, { status: 500 });\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;;;AAAA;AACA;;;AAEO,eAAe;IAClB,IAAI;QACA,MAAM,WAAW,MAAM,IAAA,oHAAK,EAAC;QAC7B,MAAM,QAAQ,MAAM,IAAA,oHAAK,EAAC;QAE1B,OAAO,gJAAY,CAAC,IAAI,CAAC;YACrB,SAAS;YACT,UAAU,QAAQ,CAAC,EAAE,IAAI;YACzB,OAAO;QACX;IACJ,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,uBAAuB;QACrC,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;YAAO,OAAO,MAAM,OAAO;QAAC,GAAG;YAAE,QAAQ;QAAI;IACrF;AACJ;AAEO,eAAe,IAAI,OAAO;IAC7B,IAAI;QACA,MAAM,OAAO,MAAM,QAAQ,IAAI;QAC/B,MAAM,EACF,WAAW,EAAE,YAAY,EAAE,WAAW,EAAE,OAAO,EAAE,KAAK,EAAE,KAAK,EAAE,SAAS,EACxE,SAAS,EAAE,UAAU,EAAE,kBAAkB,EAAE,gBAAgB,EAC3D,sBAAsB,EAAE,oBAAoB,EAC/C,GAAG;QAEJ,MAAM,SAAS,MAAM,IAAA,oHAAK,EACtB,CAAC;;;;mBAIM,CAAC,EACR;YACI;YAAa;YAAc;YAAa;YAAS;YAAO;YAAO;YAC/D,YAAY,IAAI;YAAG;YAAY;YAAoB;YACnD;YAAwB;SAC3B;QAGL,IAAI,OAAO,YAAY,KAAK,GAAG;YAC3B,uDAAuD;YACvD,MAAM,IAAA,oHAAK,EACP,CAAC;;;;;uDAKsC,CAAC,EACxC;gBACI;gBAAa;gBAAc;gBAAa;gBAAS;gBAAO;gBAAO;gBAC/D,YAAY,IAAI;gBAAG;gBAAY;gBAAoB;gBACnD;gBAAwB;aAC3B;QAET;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;YAAM,SAAS;QAAoC;IAC3F,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,wBAAwB;QACtC,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;YAAO,OAAO,MAAM,OAAO;QAAC,GAAG;YAAE,QAAQ;QAAI;IACrF;AACJ"}}]
}
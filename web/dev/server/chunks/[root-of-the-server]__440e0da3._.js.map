{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Lenovo11/Desktop/xx/spicc.ac.th-main/lib/db.js"],"sourcesContent":["import mysql from 'mysql2/promise';\r\n// Ensure mysql2 is used as a server-only package\r\n\r\nlet pool = global.dbPool || null;\r\n\r\nfunction getPool() {\r\n    if (!pool) {\r\n        pool = mysql.createPool({\r\n            host: process.env.DB_HOST,\r\n            user: process.env.DB_USER,\r\n            password: process.env.DB_PASSWORD,\r\n            database: process.env.DB_NAME,\r\n            port: parseInt(process.env.DB_PORT || '3306'),\r\n            waitForConnections: true,\r\n            connectionLimit: 10,\r\n            queueLimit: 0,\r\n            connectTimeout: 30000,\r\n            enableKeepAlive: true,\r\n            keepAliveInitialDelay: 0,\r\n            charset: 'utf8mb4',\r\n        });\r\n        global.dbPool = pool;\r\n    }\r\n    return pool;\r\n}\r\n\r\nexport async function query(sql, params = []) {\r\n    const pool = getPool();\r\n    const [rows] = await pool.execute(sql, params);\r\n    return rows;\r\n}\r\n\r\nexport default getPool;\r\n"],"names":[],"mappings":";;;;;;AAAA;;AACA,iDAAiD;AAEjD,IAAI,OAAO,yDAAO,MAAM,IAAI;AAE5B,SAAS;IACL,IAAI,CAAC,MAAM;QACP,OAAO,mLAAK,CAAC,UAAU,CAAC;YACpB,MAAM,QAAQ,GAAG,CAAC,OAAO;YACzB,MAAM,QAAQ,GAAG,CAAC,OAAO;YACzB,UAAU,QAAQ,GAAG,CAAC,WAAW;YACjC,UAAU,QAAQ,GAAG,CAAC,OAAO;YAC7B,MAAM,SAAS,QAAQ,GAAG,CAAC,OAAO,IAAI;YACtC,oBAAoB;YACpB,iBAAiB;YACjB,YAAY;YACZ,gBAAgB;YAChB,iBAAiB;YACjB,uBAAuB;YACvB,SAAS;QACb;QACA,yDAAO,MAAM,GAAG;IACpB;IACA,OAAO;AACX;AAEO,eAAe,MAAM,GAAG,EAAE,SAAS,EAAE;IACxC,MAAM,OAAO;IACb,MAAM,CAAC,KAAK,GAAG,MAAM,KAAK,OAAO,CAAC,KAAK;IACvC,OAAO;AACX;uCAEe"}},
    {"offset": {"line": 86, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Lenovo11/Desktop/xx/spicc.ac.th-main/app/api/personnel/settings/route.js"],"sourcesContent":["import { NextResponse } from 'next/server';\r\nimport { query } from '@/lib/db';\r\nimport { revalidatePath } from 'next/cache';\r\n\r\nexport async function GET() {\r\n    try {\r\n        const settings = await query('SELECT * FROM cms_personnel_settings LIMIT 1');\r\n        if (settings.length > 0) {\r\n            return NextResponse.json({ success: true, settings: settings[0] });\r\n        }\r\n        return NextResponse.json({\r\n            success: true,\r\n            settings: {\r\n                personnel_title: 'คณะผู้บริหารและคณาจารย์',\r\n                personnel_description: 'ทีมผู้เชี่ยวชาญที่มีประสบการณ์ พร้อมถ่ายทอดความรู้และนวัตกรรมเพื่อส่งเสริมศักยภาพของผู้เรียนอย่างเต็มที่'\r\n            }\r\n        });\r\n    } catch (error) {\r\n        return NextResponse.json({ success: false, error: error.message }, { status: 500 });\r\n    }\r\n}\r\n\r\nexport async function PUT(request) {\r\n    try {\r\n        const body = await request.json();\r\n        const { personnel_title, personnel_description } = body;\r\n\r\n        const existing = await query('SELECT id FROM cms_personnel_settings LIMIT 1');\r\n\r\n        if (existing.length > 0) {\r\n            await query(\r\n                'UPDATE cms_personnel_settings SET personnel_title = ?, personnel_description = ? WHERE id = ?',\r\n                [personnel_title, personnel_description, existing[0].id]\r\n            );\r\n        } else {\r\n            await query(\r\n                'INSERT INTO cms_personnel_settings (personnel_title, personnel_description) VALUES (?, ?)',\r\n                [personnel_title, personnel_description]\r\n            );\r\n        }\r\n\r\n        revalidatePath('/');\r\n        revalidatePath('/personnel');\r\n        return NextResponse.json({ success: true, message: 'Settings updated successfully' });\r\n    } catch (error) {\r\n        return NextResponse.json({ success: false, error: error.message }, { status: 500 });\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AACA;;;;AAEO,eAAe;IAClB,IAAI;QACA,MAAM,WAAW,MAAM,IAAA,oHAAK,EAAC;QAC7B,IAAI,SAAS,MAAM,GAAG,GAAG;YACrB,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,SAAS;gBAAM,UAAU,QAAQ,CAAC,EAAE;YAAC;QACpE;QACA,OAAO,gJAAY,CAAC,IAAI,CAAC;YACrB,SAAS;YACT,UAAU;gBACN,iBAAiB;gBACjB,uBAAuB;YAC3B;QACJ;IACJ,EAAE,OAAO,OAAO;QACZ,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;YAAO,OAAO,MAAM,OAAO;QAAC,GAAG;YAAE,QAAQ;QAAI;IACrF;AACJ;AAEO,eAAe,IAAI,OAAO;IAC7B,IAAI;QACA,MAAM,OAAO,MAAM,QAAQ,IAAI;QAC/B,MAAM,EAAE,eAAe,EAAE,qBAAqB,EAAE,GAAG;QAEnD,MAAM,WAAW,MAAM,IAAA,oHAAK,EAAC;QAE7B,IAAI,SAAS,MAAM,GAAG,GAAG;YACrB,MAAM,IAAA,oHAAK,EACP,iGACA;gBAAC;gBAAiB;gBAAuB,QAAQ,CAAC,EAAE,CAAC,EAAE;aAAC;QAEhE,OAAO;YACH,MAAM,IAAA,oHAAK,EACP,6FACA;gBAAC;gBAAiB;aAAsB;QAEhD;QAEA,IAAA,iJAAc,EAAC;QACf,IAAA,iJAAc,EAAC;QACf,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;YAAM,SAAS;QAAgC;IACvF,EAAE,OAAO,OAAO;QACZ,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;YAAO,OAAO,MAAM,OAAO;QAAC,GAAG;YAAE,QAAQ;QAAI;IACrF;AACJ"}}]
}